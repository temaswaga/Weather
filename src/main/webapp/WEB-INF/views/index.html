<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Weather Viewer â€“ Homepage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="d-flex flex-column min-vh-100">

<nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/}"> <!-- Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ -->
            <img th:src="@{images/weather-app.png}" alt="" width="30" height="24" class="d-inline-block align-text-top">
            Weather Tracker
        </a>
        <div class="d-flex align-items-center">
            <span class="navbar-text me-3" th:text="${user.getLogin()}">User</span>
            <form th:action="@{/logout}" method="post">
                <button class="btn btn-outline-danger">Sign out</button>
            </form>
        </div>
    </div>
</nav>

<section id="page-content" class="flex-grow-1">
    <div class="container mt-4">
        <!-- Ð¤Ð¾Ñ€Ð¼Ð° Ð¿Ð¾Ð¸ÑÐºÐ° -->
        <form th:action="@{/search}" method="get" class="d-flex my-4">
            <div class="input-group location-search-input-group me-3">
                <input class="form-control" type="text" name="name" placeholder="Enter location" required>
                <button class="btn btn-outline-secondary btn-sm clear-input-button" type="button"
                        onclick="this.previousElementSibling.value=''">
                    &times;
                </button>
            </div>
            <button type="submit" class="btn btn-outline-success">Search</button>
        </form>

        <!-- Ð‘Ð»Ð¾Ðº ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ñ… Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¹ -->
        <div>
            <h2>My Watchlist:</h2>

            <div th:if="${locations == null or #lists.isEmpty(locations)}" class="text-muted">
                You haven't added any locations yet.
            </div>

            <div class="row" th:if="${locations != null and not #lists.isEmpty(locations)}">
                <div th:each="location : ${locations}" class="col-12 col-lg-3 col-md-6 mb-4">
                    <div class="card h-100 text-center border-info shadow-sm">
                        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ Ð³Ð¾Ñ€Ð¾Ð´Ð° -->
                        <div class="card-header bg-transparent border-bottom-0">
                            <h5 class="card-title mb-0 fw-bold" th:text="${location.name}">City Name</h5>
                        </div>

                        <div class="card-body d-flex flex-column justify-content-center align-items-center">
                            <!-- Ð˜ÐºÐ¾Ð½ÐºÐ° Ð¿Ð¾Ð³Ð¾Ð´Ñ‹ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ) -->
                            <img th:if="${location.icon}"
                                 th:src="@{'https://openweathermap.org/img/wn/' + ${location.icon} + '@2x.png'}"
                                 alt="Weather icon" width="80" height="80">

                            <!-- Ð¢ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð° -->
                            <h1 class="display-4 fw-bold mb-0">
                                <span th:text="${location.temperature} != null ? ${#numbers.formatDecimal(location.temperature, 1, 1)} : '--'">20.5</span>Â°C
                            </h1>

                            <!-- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ð¾Ð³Ð¾Ð´Ñ‹ (Rain, Clear Sky...) -->
                            <p class="card-text text-muted text-capitalize mb-2"
                               th:text="${location.description}">Description</p>

                            <!-- Ð”Ð¾Ð¿. Ð¸Ð½Ñ„Ð¾: Ð’ÐµÑ‚ÐµÑ€ Ð¸ ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒ (Ð¿Ð¾ Ð¶ÐµÐ»Ð°Ð½Ð¸ÑŽ) -->
                            <div class="d-flex justify-content-center gap-3 text-secondary small">
                    <span th:if="${location.windSpeed} != null">
                        ðŸ’¨ <span th:text="${location.windSpeed}">5</span> m/s
                    </span>
                                <span th:if="${location.humidity} != null">
                        ðŸ’§ <span th:text="${location.humidity}">40</span>%
                    </span>
                            </div>
                        </div>

                        <!-- ÐŸÐ¾Ð´Ð²Ð°Ð» ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ -->
                        <div class="card-footer bg-transparent border-top-0 pb-3">
                            <form method="post" th:action="@{/location/delete}">
                                <!-- ÐŸÐµÑ€ÐµÐ´Ð°ÐµÐ¼ ID Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð·Ð½Ð°Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ ÑƒÐ´Ð°Ð»ÑÑ‚ÑŒ -->
                                <!-- Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ DTO ÐµÑÑ‚ÑŒ Ð¿Ð¾Ð»Ðµ getId() Ð¸Ð»Ð¸ id -->
                                <input type="hidden" name="locationId" th:value="${location.id}"/>

                                <button type="submit" class="btn btn-sm btn-outline-danger w-100 hover-shadow">
                                    Remove
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="d-flex flex-wrap justify-content-between align-items-center py-3 mt-auto border-top">
    <div class="px-4">
        <span>Â© Weather Viewer</span>
    </div>
</footer>
</body>
</html>
